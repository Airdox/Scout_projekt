#!/bin/bash

echo "ğŸ¤ Offline Voice Cloning - Stimmenklon-Builder"
echo "============================================="
echo ""

# ÃœberprÃ¼fen ob Python installiert ist
if ! command -v python3 &> /dev/null; then
    echo "âŒ Python 3 ist nicht installiert!"
    echo "Bitte installieren Sie Python 3.8+ von https://python.org"
    exit 1
fi

echo "âœ… Python gefunden"
echo ""

# Backend Setup
echo "ğŸ”§ Backend wird vorbereitet..."
cd backend

# Virtual Environment erstellen (falls nicht vorhanden)
if [ ! -d "venv" ]; then
    echo "ğŸ“¦ Python Virtual Environment wird erstellt..."
    python3 -m venv venv
fi

# Virtual Environment aktivieren
echo "ğŸ”„ Virtual Environment wird aktiviert..."
source venv/bin/activate

# Python Dependencies installieren
echo "ğŸ“¦ Python-Pakete werden installiert..."
pip install -r requirements.txt

echo "âœ… Backend vorbereitet"
echo ""

# Backend starten
echo "ğŸš€ Backend wird gestartet (Port 8000)..."
echo "ğŸ“ Logs: backend/logs.txt"
echo ""
nohup python main.py > logs.txt 2>&1 &
BACKEND_PID=$!
echo $BACKEND_PID > backend.pid

echo "âœ… Backend lÃ¤uft (PID: $BACKEND_PID)"
echo "ğŸŒ API verfÃ¼gbar unter: http://localhost:8000"
echo "ğŸ“š API Dokumentation: http://localhost:8000/docs"
echo ""
echo "ğŸ¤ Frontend lÃ¤uft bereits unter der aktuellen URL"
echo ""
echo "â¹ï¸  Zum Beenden: ./stop.sh"